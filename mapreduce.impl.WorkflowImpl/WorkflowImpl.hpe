<?xml version="1.0" encoding="ASCII"?>
<component:component xmlns:component="http://www.example.org/HashComponent">
  <header hash_component_UID="0024000004800000940000000602000000240000525341310004000011000000e96ceca91e9d136e1c11b91012715b78835c3224c8047832531b8b4f38e5189174887e8c7253510bf693cab38e2265b0caedddc992241bf0706b21b39270b6cd534bc1cc4964ac906f2c55a4e358d32b1faa9fb0b53bf23bd72001226c1ed8e064799997a2fa5bf4d782bbac8cfa9d62404fe6eb3e04607857e7552ff64e6095" isAbstract="false" kind="Computation" name="WorkflowImpl" packagePath="mapreduce.impl">
    <baseType>
      <extensionType>
        <implements>true</implements>
      </extensionType>
      <component hash_component_UID="002400000480000094000000060200000024000052534131000400001100000047003692afa7ed3b984286e080e9dd8c89f4270ba88b985b13900fab43674166c5a82e084b79bcb6e42b66296c8bd48ce530aca8ef29be9cb870dab193cbecd1d76a807fd28f483b1b95d4d9f19616755f19b1d6271a54893f0aac8040489eb19ff2211acf21eb9a4e42af37cb064a4a66a0e876a38f0e9717e9708c65f638a6" localRef="base" location="mapreduce.Workflow/Workflow.hpe" name="Workflow" package="mapreduce" version="1.0.0.0">
        <visualDescription h="50" w="100" x="116" y="155">
          <color b="255" g="255" r="255"/>
        </visualDescription>
        <port localRef="task_map" location="br.ufc.mdcc.hpcshelf.mapreduce.binding.task.TaskBindingAdvance/TaskBindingAdvance.hpe" multiple="false" name="TaskBindingAdvance" package="br.ufc.mdcc.hpcshelf.mapreduce.binding.task" exposed="true">
          <visualDescription h="42" w="70" x="197" y="460">
            <color b="243" g="217" r="217"/>
          </visualDescription>
          <unitBounds parallel="true" uRef="peer">
            <visualDescription h="30" w="20" x="10" y="10"/>
          </unitBounds>
        </port>
        <port localRef="task_reduce" location="br.ufc.mdcc.hpcshelf.mapreduce.binding.task.TaskBindingAdvance/TaskBindingAdvance.hpe" multiple="false" name="TaskBindingAdvance" package="br.ufc.mdcc.hpcshelf.mapreduce.binding.task" exposed="true">
          <visualDescription h="42" w="70" x="96" y="445">
            <color b="243" g="217" r="217"/>
          </visualDescription>
          <unitBounds parallel="true" uRef="peer">
            <visualDescription h="30" w="20" x="10" y="10"/>
          </unitBounds>
        </port>
        <port localRef="task_binding_split_first" location="br.ufc.mdcc.hpcshelf.mapreduce.binding.task.TaskBindingAdvance/TaskBindingAdvance.hpe" multiple="false" name="TaskBindingAdvance" package="br.ufc.mdcc.hpcshelf.mapreduce.binding.task" exposed="true">
          <visualDescription h="42" w="253" x="112" y="642">
            <color b="243" g="217" r="217"/>
          </visualDescription>
          <unitBounds parallel="true" uRef="peer">
            <visualDescription h="30" w="20" x="10" y="10"/>
          </unitBounds>
        </port>
        <port localRef="task_binding_split_next" location="br.ufc.mdcc.hpcshelf.mapreduce.binding.task.TaskBindingAdvance/TaskBindingAdvance.hpe" multiple="false" name="TaskBindingAdvance" package="br.ufc.mdcc.hpcshelf.mapreduce.binding.task" exposed="true">
          <visualDescription h="42" w="253" x="333" y="749">
            <color b="243" g="217" r="217"/>
          </visualDescription>
          <unitBounds parallel="true" uRef="peer">
            <visualDescription h="30" w="20" x="10" y="10"/>
          </unitBounds>
        </port>
        <port localRef="task_binding_data" location="br.ufc.mdcc.hpcshelf.mapreduce.binding.task.TaskBindingData/TaskBindingData.hpe" multiple="false" name="TaskBindingData" package="br.ufc.mdcc.hpcshelf.mapreduce.binding.task" exposed="true">
          <visualDescription h="42" w="70" x="23" y="154">
            <color b="243" g="217" r="217"/>
          </visualDescription>
          <unitBounds parallel="true" uRef="peer">
            <visualDescription h="23" w="20" x="79" y="7"/>
          </unitBounds>
        </port>
        <port localRef="task_binding_shuffle" location="br.ufc.mdcc.hpcshelf.mapreduce.binding.task.TaskBindingAdvance/TaskBindingAdvance.hpe" multiple="false" name="TaskBindingAdvance" package="br.ufc.mdcc.hpcshelf.mapreduce.binding.task" exposed="true">
          <visualDescription h="42" w="181" x="83" y="259">
            <color b="243" g="217" r="217"/>
          </visualDescription>
          <unitBounds parallel="true" uRef="peer">
            <visualDescription h="30" w="20" x="10" y="10"/>
          </unitBounds>
        </port>
        <unitBounds parallel="false" uRef="workflow_unit">
          <visualDescription h="20" w="20" x="5" y="2"/>
        </unitBounds>
      </component>
    </baseType>
    <versions field1="1" field2="0" field3="0" field4="0"/>
    <visualAttributes>
      <color b="255" g="255" r="255"/>
    </visualAttributes>
  </header>
  <componentInfo>
    <interface iRef="IWorkflowImpl" nArgs="0">
      <slice isRef="task_binding_shuffle">
        <originRef cRef="task_binding_shuffle" iRef="ITaskBindingAdvance"/>
        <visualDescription h="15" w="15" x="10" y="10"/>
      </slice>
      <slice isRef="task_reduce">
        <originRef cRef="task_reduce" iRef="ITaskBindingAdvance"/>
        <visualDescription h="15" w="15" x="10" y="10"/>
      </slice>
      <slice isRef="task_binding_split_first">
        <originRef cRef="task_binding_split_first" iRef="ITaskBindingAdvance"/>
        <visualDescription h="15" w="15" x="10" y="10"/>
      </slice>
      <slice isRef="task_binding_data">
        <originRef cRef="task_binding_data" iRef="ITaskBindingData"/>
        <visualDescription h="15" w="15" x="10" y="10"/>
      </slice>
      <slice isRef="task_binding_split_next">
        <originRef cRef="task_binding_split_next" iRef="ITaskBindingAdvance"/>
        <visualDescription h="15" w="15" x="10" y="10"/>
      </slice>
      <slice isRef="task_map">
        <originRef cRef="task_map" iRef="ITaskBindingAdvance"/>
        <visualDescription h="15" w="15" x="10" y="10"/>
      </slice>
      <sources sourceType="C# Language" versionId="1.0.0.0">
        <file contents="// ------------------------------------------------------------------------------&#xA;//  &lt;autogenerated>&#xA;//      This code was generated by a tool.&#xA;//      Mono Runtime Version: 4.0.30319.17020&#xA;// &#xA;//      Changes to this file may cause incorrect behavior and will be lost if &#xA;//      the code is regenerated.&#xA;//  &lt;/autogenerated>&#xA;// ------------------------------------------------------------------------------&#xA;using br.ufc.mdcc.hpc.storm.binding.task.TaskBindingBase;&#xA;using br.ufc.mdcc.hpcshelf.mapreduce.binding.task.TaskBindingData;&#xA;using br.ufc.mdcc.hpcshelf.mapreduce.binding.task.TaskBindingAdvance;&#xA;using System.Threading;&#xA;using br.ufc.mdcc.hpcshelf.mapreduce.port.task.TaskPortTypeData;&#xA;using br.ufc.mdcc.hpcshelf.mapreduce.port.task.TaskPortTypeAdvance;&#xA;using System;&#xA;using mapreduce.Workflow;&#xA;using System.Collections.Generic;&#xA;&#xA;&#xA;namespace mapreduce.impl.WorkflowImpl {&#xA;    &#xA;    &#xA;&#x9;public class IWorkflowImpl : br.ufc.pargo.hpe.kinds.Computation, IWorkflow {&#xA;        &#xA;&#x9;&#x9;private void read_data_source()&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Console.WriteLine (&quot;read_data_source&quot;);&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;private void split_perform()&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Console.WriteLine (&quot;split_perform&quot;);&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private void map_perform()&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Console.WriteLine (&quot;map_perform&quot;);&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private void shuffle_perform()&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Console.WriteLine (&quot;shuffle_perform&quot;);&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private void reduce_perform()&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Console.WriteLine (&quot;reduce_perform&quot;);&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private void write_sink_source()&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Console.WriteLine (&quot;write_sink_source&quot;);&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;public override void main() &#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 2&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;IActionFutureSet future_iteration = null;&#xA;&#xA;&#x9;&#x9;&#x9;IActionFuture future_split_first_chunk_ready = null;&#xA;&#x9;&#x9;    Task_port_split_first.invoke (ITaskPortAdvance.CHUNK_READY, out future_split_first_chunk_ready);&#xA;&#x9;&#x9;&#x9;int action_id_split_first_chunk_ready = future_split_first_chunk_ready.GetHashCode ();&#xA;&#x9;&#x9;&#x9;future_iteration = future_split_first_chunk_ready.createSet ();&#xA;&#xA;&#x9;&#x9;&#x9;IActionFuture future_split_next_chunk_ready = null;&#xA;&#x9;&#x9;&#x9;Task_port_split_next.invoke (ITaskPortAdvance.CHUNK_READY, out future_split_next_chunk_ready);&#xA;&#x9;&#x9;&#x9;int action_id_split_next_chunk_ready = future_split_next_chunk_ready.GetHashCode ();&#xA;&#x9;&#x9;&#x9;future_iteration.addAction(future_split_next_chunk_ready)&#x9;;&#xA;&#xA;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 3&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;IActionFuture future_map_chunk_ready = null;&#xA;&#x9;&#x9;&#x9;Task_port_map.invoke (ITaskPortAdvance.CHUNK_READY, out future_map_chunk_ready);&#xA;&#x9;&#x9;&#x9;int action_id_map_chunk_ready = future_map_chunk_ready.GetHashCode ();&#xA;&#x9;&#x9;&#x9;future_iteration.addAction (future_map_chunk_ready);&#xA;&#xA;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 4&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;IActionFuture future_shuffle_chunk_ready = null; &#xA;&#x9;&#x9;&#x9;Task_port_shuffle.invoke (ITaskPortAdvance.CHUNK_READY, out future_shuffle_chunk_ready);&#xA;&#x9;&#x9;&#x9;int action_id_shuffle_chunk_ready = future_shuffle_chunk_ready.GetHashCode ();&#xA;&#x9;&#x9;&#x9;future_iteration.addAction (future_shuffle_chunk_ready);&#xA;&#xA;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 4&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;IActionFuture future_reduce_chunk_ready = null;&#xA;&#x9;&#x9;&#x9;Task_port_reduce.invoke (ITaskPortAdvance.CHUNK_READY, out future_reduce_chunk_ready);&#xA;&#x9;&#x9;&#x9;int action_id_reduce_chunk_ready = future_reduce_chunk_ready.GetHashCode ();&#xA;&#x9;&#x9;&#x9;future_iteration.addAction (future_reduce_chunk_ready);&#xA;&#xA;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 5&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;IActionFuture future_data_terminate = null; &#xA;&#x9;&#x9;&#x9;Task_port_data.invoke (ITaskPortData.TERMINATE, out future_data_terminate);&#xA;&#x9;&#x9;&#x9;future_iteration.addAction (future_data_terminate);&#xA;&#x9;&#x9;&#x9;int action_id_data_terminate = future_data_terminate.GetHashCode ();&#xA;&#xA;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 6-1&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;Task_port_data.invoke (ITaskPortData.READ_SOURCE);&#xA;&#xA;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 6-2&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;Task_port_split_first.invoke (ITaskPortAdvance.READ_CHUNK);&#xA;&#x9;&#x9;&#x9;Task_port_split_first.invoke (ITaskPortAdvance.PERFORM);&#xA;&#xA;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 7&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;IList&lt;Thread> bag_of_tasks = new List&lt;Thread> ();&#xA;&#xA;&#x9;&#x9;&#x9;Task_port_data.TraceFlag = Task_port_map.TraceFlag = Task_port_reduce.TraceFlag = Task_port_shuffle.TraceFlag = Task_port_split_first.TraceFlag = Task_port_split_next.TraceFlag = true;&#xA;&#x9;&#x9;&#x9;Task_binding_data.TraceFlag = Task_binding_shuffle.TraceFlag = Task_binding_split_first.TraceFlag = Task_binding_split_next.TraceFlag = true;&#xA;&#xA;&#x9;&#x9;&#x9;bool terminate = false;&#xA;&#x9;&#x9;&#x9;do &#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (this.ThisFacetInstance + &quot;/&quot; + this.Rank + &quot;: WORKFLOW 8 - LOOP&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;IActionFuture action = future_iteration.waitAny ();&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;int action_id = action.GetHashCode();&#xA;&#x9;&#x9;&#x9;&#x9;if (action_id == action_id_split_first_chunk_ready)&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Thread t1 = new Thread((ThreadStart)delegate() &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE MAPPER READ_CHUNK - BEFORE&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_map.invoke (ITaskPortAdvance.READ_CHUNK); //****&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE MAPPER READ_CHUNK - AFTER&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;IActionFuture future_map_perform = null;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Thread thread_map_perform = Task_port_map.invoke (ITaskPortAdvance.PERFORM, map_perform, out future_map_perform);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;END INVOKE SPLITTER CHUNK_READY&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;});&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;bag_of_tasks.Add(t1);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;t1.Start();&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Thread t2 = new Thread((ThreadStart)delegate() &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;{ &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SPLITTER READ_CHUNK&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_split_first.invoke (ITaskPortAdvance.READ_CHUNK);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SPLITTER PERFORM&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_split_first.invoke (ITaskPortAdvance.PERFORM);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SPLITTER READ_CHUNK/PERFORM - AFTER&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;IActionFuture future_split_chunk_ready_ = null;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_split_first.invoke (ITaskPortAdvance.CHUNK_READY, out future_split_chunk_ready_);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;action_id_split_first_chunk_ready = future_split_chunk_ready_.GetHashCode ();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;future_iteration.addAction(future_split_chunk_ready_);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;});&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;THREAD LAUNCHED 1&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;bag_of_tasks.Add(t2);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;t2.Start();&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;else if (action_id == action_id_map_chunk_ready)&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_map.invoke (ITaskPortAdvance.CHUNK_READY, out future_map_chunk_ready);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;action_id_map_chunk_ready = future_map_chunk_ready.GetHashCode ();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;future_iteration.addAction(future_map_chunk_ready);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Thread t = new Thread((ThreadStart)delegate() &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;{&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SHUFFLER READ_CHUNK - BEFORE&quot;);  // 110 executados (o 48 completou nos pares, mas n&#xe3;o progrediu aqui (????), motivo do erro.&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_shuffle.invoke (ITaskPortAdvance.READ_CHUNK);   // &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SHUFFLER READ_CHUNK - AFTER&quot;);   // 47 completados &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;IActionFuture future_shuffle_perform = null;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Thread thread_shuffle_perform = Task_port_shuffle.invoke (ITaskPortAdvance.PERFORM, shuffle_perform, out future_shuffle_perform);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;END INVOKE MAPPER CHUNK_READY&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;});&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;t.Start();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;bag_of_tasks.Add(t);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;THREAD LAUNCHED 2&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;else if (action_id == action_id_shuffle_chunk_ready)&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_shuffle.invoke (ITaskPortAdvance.CHUNK_READY, out future_shuffle_chunk_ready);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;action_id_shuffle_chunk_ready = future_shuffle_chunk_ready.GetHashCode ();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;future_iteration.addAction(future_shuffle_chunk_ready);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Thread t = new Thread((ThreadStart)delegate() &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE REDUCER READ_CHUNK - BEFORE&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_reduce.invoke (ITaskPortAdvance.READ_CHUNK); // ****&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE REDUCER READ_CHUNK - AFTER&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;IActionFuture future_reduce_perform = null;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Thread thread_reduce_perform = Task_port_reduce.invoke (ITaskPortAdvance.PERFORM, reduce_perform, out future_reduce_perform);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;END INVOKE SHUFFLER CHUNK_READY&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;});&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;t.Start();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;bag_of_tasks.Add(t);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;THREAD LAUNCHED 3&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;else if (action_id == action_id_reduce_chunk_ready)&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_reduce.invoke (ITaskPortAdvance.CHUNK_READY, out future_reduce_chunk_ready);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;action_id_reduce_chunk_ready = future_reduce_chunk_ready.GetHashCode ();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;future_iteration.addAction(future_reduce_chunk_ready);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Thread t = new Thread((ThreadStart)delegate() &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SPLITTER NEXT READ_CHUNK - BEFORE&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_split_next.invoke (ITaskPortAdvance.READ_CHUNK);  // ****&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SPLITTER NEXT READ_CHUNK - AFTER&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;IActionFuture future_split_perform = null;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Thread thread_split_perform = Task_port_split_next.invoke (ITaskPortAdvance.PERFORM, split_perform, out future_split_perform);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;END INVOKE REDUCER CHUNK_READY&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;});&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;t.Start();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;bag_of_tasks.Add(t);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;THREAD LAUNCHED 4&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;else if  (action_id == action_id_split_next_chunk_ready)&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Thread t1 = new Thread((ThreadStart)delegate() &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE MAP READ_CHUNK NEXT - BEFORE&quot;);  &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_map.invoke (ITaskPortAdvance.READ_CHUNK);   // &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE MAP READ_CHUNK NEXT - AFTER&quot;);    &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;IActionFuture future_map_perform = null;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Thread thread_map_perform = Task_port_map.invoke (ITaskPortAdvance.PERFORM, map_perform, out future_map_perform);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;END INVOKE SPLIT NEXT CHUNK_READY&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;});&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;bag_of_tasks.Add(t1);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;t1.Start();&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Thread t2 = new Thread((ThreadStart)delegate() &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;{ &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SPLITTER NEXT READ_CHUNK&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_split_next.invoke (ITaskPortAdvance.READ_CHUNK);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SPLITTER NEXT PERFORM&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_split_next.invoke (ITaskPortAdvance.PERFORM);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE SPLITTER NEXT READ_CHUNK/PERFORM - AFTER&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;IActionFuture future_split_next_chunk_ready_ = null;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_split_next.invoke (ITaskPortAdvance.CHUNK_READY, out future_split_next_chunk_ready_);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;action_id_split_next_chunk_ready = future_split_next_chunk_ready_.GetHashCode ();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;future_iteration.addAction(future_split_next_chunk_ready_);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;});&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;THREAD LAUNCHED 1&quot;);&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;bag_of_tasks.Add(t2);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;t2.Start();&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;THREAD LAUNCHED 5&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;else if (action_id == action_id_data_terminate)&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Thread t = new Thread((ThreadStart)delegate() &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE DATA WRITE_SINK - BEFORE&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Task_port_data.invoke (ITaskPortData.WRITE_SINK);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;INVOKE DATA WRITE_SINK - AFTER&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;terminate = true;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;});&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;t.Start();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;bag_of_tasks.Add(t);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine (&quot;THREAD LAUNCHED 6&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;else&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Console.WriteLine(&quot;UNEXPECTED ERROR: ACTION FUTURE NOT RECOGNIZED ! &quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;} while (!terminate) ;&#xA;&#xA;&#x9;&#x9;&#x9;Console.WriteLine(&quot;WORKFLOW FINISHED ! &quot;);&#xA;&#xA;&#x9;&#x9;&#x9;foreach (Thread t in bag_of_tasks)&#xA;&#x9;&#x9;&#x9;&#x9;t.Join ();&#xA;&#xA;        }&#xA;&#xA;&#x9;&#x9;private ITaskPort&lt;ITaskPortTypeData> task_port_data = null;&#xA;&#x9;&#x9;protected ITaskPort&lt;ITaskPortTypeData> Task_port_data &#xA;&#x9;&#x9;{ &#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{   &#xA;&#x9;&#x9;&#x9;&#x9;if (task_port_data == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_port_data = (ITaskPort&lt;ITaskPortTypeData>)this.Services.getPort (&quot;task_port_data&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_port_data;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private ITaskPort&lt;ITaskPortTypeAdvance> task_port_split_first = null;&#xA;&#x9;&#x9;protected ITaskPort&lt;ITaskPortTypeAdvance> Task_port_split_first&#xA;&#x9;&#x9;{ &#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{   if (task_port_split_first == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_port_split_first = (ITaskPort&lt;ITaskPortTypeAdvance>) this.Services.getPort (&quot;task_port_split_first&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_port_split_first;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private ITaskPort&lt;ITaskPortTypeAdvance> task_port_split_next = null;&#xA;&#x9;&#x9;protected ITaskPort&lt;ITaskPortTypeAdvance> Task_port_split_next&#xA;&#x9;&#x9;{ &#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{   if (task_port_split_next == null)&#xA;&#x9;&#x9;&#x9;&#x9;task_port_split_next = (ITaskPort&lt;ITaskPortTypeAdvance>) this.Services.getPort (&quot;task_port_split_next&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_port_split_next;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private ITaskPort&lt;ITaskPortTypeAdvance> task_port_shuffle = null;&#xA;&#x9;&#x9;protected ITaskPort&lt;ITaskPortTypeAdvance> Task_port_shuffle &#xA;&#x9;&#x9;{ &#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{   &#xA;&#x9;&#x9;&#x9;&#x9;if (task_port_shuffle == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_port_shuffle = (ITaskPort&lt;ITaskPortTypeAdvance>) this.Services.getPort (&quot;task_port_shuffle&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_port_shuffle;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private ITaskPort&lt;ITaskPortTypeAdvance> task_port_reduce = null;&#xA;&#x9;&#x9;protected ITaskPort&lt;ITaskPortTypeAdvance> Task_port_reduce &#xA;&#x9;&#x9;{ &#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{   &#xA;&#x9;&#x9;&#x9;&#x9;if (task_port_reduce == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_port_reduce = (ITaskPort&lt;ITaskPortTypeAdvance>) this.Services.getPort (&quot;task_port_reduce&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_port_reduce;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private ITaskPort&lt;ITaskPortTypeAdvance> task_port_map = null;&#xA;&#x9;&#x9;protected ITaskPort&lt;ITaskPortTypeAdvance> Task_port_map &#xA;&#x9;&#x9;{ &#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{  &#xA;&#x9;&#x9;&#x9;&#x9;if (task_port_map == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_port_map = (ITaskPort&lt;ITaskPortTypeAdvance>) this.Services.getPort (&quot;task_port_map&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_port_map;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private ITaskBindingAdvance task_binding_shuffle; &#xA;&#x9;&#x9;public ITaskBindingAdvance Task_binding_shuffle &#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{  &#xA;&#x9;&#x9;&#x9;&#x9;if (task_binding_shuffle == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_binding_shuffle = (ITaskBindingAdvance) this.Services.getPort (&quot;task_binding_shuffle&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_binding_shuffle;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private  ITaskBindingAdvance task_binding_split_first; &#xA;&#x9;&#x9;public ITaskBindingAdvance Task_binding_split_first &#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{  &#xA;&#x9;&#x9;&#x9;&#x9;if (task_binding_split_first == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_binding_split_first = (ITaskBindingAdvance) this.Services.getPort (&quot;task_binding_split_first&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_binding_split_first;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private  ITaskBindingAdvance task_binding_split_next; &#xA;&#x9;&#x9;public ITaskBindingAdvance Task_binding_split_next&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{  &#xA;&#x9;&#x9;&#x9;&#x9;if (task_binding_split_next == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_binding_split_next = (ITaskBindingAdvance) this.Services.getPort (&quot;task_binding_split_next&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_binding_split_next;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#xA;&#x9;&#x9;private ITaskBindingAdvance task_reduce; &#xA;&#x9;&#x9;public ITaskBindingAdvance Task_reduce &#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{  &#xA;&#x9;&#x9;&#x9;&#x9;if (task_reduce == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_reduce = (ITaskBindingAdvance) this.Services.getPort (&quot;task_reduce&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_reduce;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private ITaskBindingAdvance task_map;&#xA;&#x9;&#x9;public ITaskBindingAdvance Task_map &#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{  &#xA;&#x9;&#x9;&#x9;&#x9;if (task_map == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_map = (ITaskBindingAdvance) this.Services.getPort (&quot;task_map&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_map;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;private ITaskBindingData task_binding_data;&#xA;&#x9;&#x9;public ITaskBindingData Task_binding_data &#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;get &#xA;&#x9;&#x9;&#x9;{   &#xA;&#x9;&#x9;&#x9;&#x9;if (task_binding_data == null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;task_binding_data = (ITaskBindingData) this.Services.getPort (&quot;task_binding_data&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;return task_binding_data;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;    }&#xA;}&#xA;" name="IWorkflowImpl.cs" srcType="user" uri="mapreduce.impl.WorkflowImpl/bin/1.0.0.0/IWorkflowImpl.dll" versionId="1.0.0.0"/>
      </sources>
      <visualDescription h="100" w="150" x="196" y="294">
        <color b="20" g="20" r="20"/>
      </visualDescription>
      <port name="task_binding_shuffle">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_binding_shuffle" sRef="task_binding_shuffle"/>
      </port>
      <port name="task_port_shuffle">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_port" sRef="task_binding_shuffle"/>
      </port>
      <port name="task_reduce">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_reduce" sRef="task_reduce"/>
      </port>
      <port name="task_port_reduce">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_port" sRef="task_reduce"/>
      </port>
      <port name="task_binding_split_first">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_binding_split_first" sRef="task_binding_split_first"/>
      </port>
      <port name="task_port_split_first">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_port" sRef="task_binding_split_first"/>
      </port>
      <port name="task_binding_data">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_binding_data" sRef="task_binding_data"/>
      </port>
      <port name="task_port_data">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_port" sRef="task_binding_data"/>
      </port>
      <port name="task_binding_split_next">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_binding_split_next" sRef="task_binding_split_next"/>
      </port>
      <port name="task_port_split_next">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_port" sRef="task_binding_split_next"/>
      </port>
      <port name="task_map">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_map" sRef="task_map"/>
      </port>
      <port name="task_port_map">
        <visualDescription h="10" w="10" x="0" y="0"/>
        <slice pRef="task_port" sRef="task_map"/>
      </port>
      <action id="main">
        <protocol/>
      </action>
    </interface>
    <unit facet="0" iRef="IWorkflowImpl" multiple="false" private="false" replica="0" uRef="workflow_unit" visibleInterface="true">
      <super cRef="base" uRef="workflow_unit"/>
      <visualDescription h="100" w="150" x="299" y="81"/>
    </unit>
  </componentInfo>
</component:component>